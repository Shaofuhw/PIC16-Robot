MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 
                      00002 ;============================================================================-
                      00003 ;                  PROYECTO ROBOT CONTROL POR PALMADAS
                      00004 ;-----------------------------------------------------------------------------
                      00005 ;    
                      00006 ;-- Microcontrolador: PIC16F883                 
                      00007 ;-- Curso: 2015/2016
                      00008 ;-- Autores: Manuel Carrasco, Shao Fu Hu Wu, David Chamizo, Eva Masero
                      00009 ;    
                      00010 ;---------------------------- Descripción -------------------------------------
                      00011 ; En este programa se realiza el control del robot en función del número de
                      00012 ; palmadas recibidas. El robot reacciona ante obstáculos en su trayectoria   
                      00013 ;==============================================================================
                      00014   
                      00015     
                      00016 #INCLUDE <P16F883.INC>   ;archivo de descripción  
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : Aug 13 2015
                      00005 ;  MPASM PIC16F883 processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2015 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      00781         LIST
                      00017 
                      00018 ;----Bits de configuracion-----
                      00019     
2007   0FF5           00020  __CONFIG _CONFIG1, _INTOSC & _LVP_OFF & _WDT_OFF & _DEBUG_ON ;Reloj interno, Prog.bajo voltaje OFF, wat
                            chdog OFF, pines RB6,RB7 depuración
2008   3EFF           00021  __CONFIG _CONFIG2, _BOR21V ;Brown-out Reset set to 2.1V
                      00022         
                      00023 ;------Variables---------------
                      00024     CBLOCK  0X20 
  00000020            00025   DLAY
  00000021            00026   PALMADAS
  00000022            00027   NPALMADAS
  00000023            00028   TIMER
                      00029   
  00000024            00030   STATUS_TEMP
  00000025            00031   W_TEMP
  00000026            00032   PORTA_TEMP
                      00033   
  00000027            00034   SILED
  00000028            00035   CONTADOR
  00000029            00036   CONTADOR2 
  0000002A            00037   CONTADOR3    
                      00038     ENDC
                      00039    
                      00040 ;--- Otras Definiciones ------ 
                      00041 ;--- Movimiento motores ---    
                      00042 #DEFINE DER_RET      PORTA,RA1
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00043 #DEFINE DER_AV       PORTA,RA2
                      00044 #DEFINE IZQ_RET      PORTA,RA3
                      00045 #DEFINE IZQ_AV       PORTA,RA4
                      00046 
                      00047 #DEFINE LED          PORTC,RC4    
                      00048 #DEFINE LED_DEL_DER  PORTC,RC6
                      00049 #DEFINE LED_DEL_IZQ  PORTB,RB3
                      00050 #DEFINE LED_TRAS_IZQ PORTB,RB4
                      00051 #DEFINE LED_TRAS_DER PORTC,RC5
                      00052    
                      00053 #DEFINE TRIG         PORTA,RA5
                      00054   
                      00055 ;----Vector de reset ---------
                      00056         ORG     0X00
0000   2???           00057         GOTO    INICIO  
                      00058         
                      00059 ;----Vector de interrupción---  
                      00060         ORG     0X04
0004   2???           00061         GOTO    INTERRUPCION
                      00062         
                      00063 ;----Definición de macros-----
                      00064 #INCLUDE <MACROS.INC>   
                      00001 ;-------------------------------------------------------------------------
                      00002 ;                               Macros                      
                      00003 ;-------------------------------------------------------------------------
                      00004         
                      00005         
                      00006 ;-------------------------------------------------------------------------      
                      00007 ;----     Direccionamiento directo a los bancos de memoria de datos   ----
                      00008 ;-------------------------------------------------------------------------
                      00009         
                      00010 ;---- Acceso directo a banco 0 ----             
                      00011 BANCO0  MACRO
                      00012         BCF     STATUS,RP1
                      00013         BCF     STATUS,RP0
                      00014         ENDM
                      00015 ;---- Acceso directo a banco 1 -----
                      00016 BANCO1  MACRO
                      00017         BCF     STATUS,RP1
                      00018         BSF     STATUS,RP0
                      00019         ENDM        
                      00020 ;---- Acceso directo a banco 2 -----
                      00021 BANCO2  MACRO
                      00022         BSF     STATUS,RP1
                      00023         BCF     STATUS,RP0
                      00024         ENDM
                      00025 ;---- Acceso directo a banco 3 -----
                      00026 BANCO3  MACRO
                      00027         BSF     STATUS,RP1
                      00028         BSF     STATUS,RP0
                      00029         ENDM    
                      00030 
                      00031         
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00032 ;-------------------------------------------------------------------------      
                      00033 ;----                   Movimiento del coche                          ----
                      00034 ;-------------------------------------------------------------------------
                      00035         
                      00036 RETROC  MACRO
                      00037         BANCO0
                      00038         BSF     DER_RET         ;Rueda derecha hacia atrás
                      00039         BSF     IZQ_RET         ;Rueda izquierda hacia atrás
                      00040         ENDM
                      00041         
                      00042 AVANCE  MACRO
                      00043         BANCO0
                      00044         BSF     DER_AV          ;Rueda derecha hacia delante        
                      00045         BSF     IZQ_AV          ;Rueda izquierda hacia delante
                      00046         ENDM
                      00047         
                      00048 GIRO_D  MACRO
                      00049         BANCO0
                      00050         BSF     IZQ_AV          ;Rueda izquierda hacia delante
                      00051         BSF     DER_RET         ;Rueda derecha hacia atrás
                      00052         ENDM
                      00053         
                      00054 GIRO_I  MACRO
                      00055         BANCO0
                      00056         BSF     DER_AV          ;Rueda derecha hacia delante
                      00057         BSF     IZQ_RET         ;Rueda izquierda hacia atrás
                      00058         ENDM
                      00059         
                      00060 PARO    MACRO
                      00061         BANCO0
                      00062         BCF     DER_RET         
                      00063         BCF     DER_AV
                      00064         BCF     IZQ_AV
                      00065         BCF     IZQ_RET
                      00066         ENDM    
                      00067         
                      00065 
                      00066 
                      00067 ;=============================================================================
                      00068 ;                            Programa Principal
                      00069 ;=============================================================================
                      00070         ORG     0X06
0006                  00071 INICIO  
0006   2???           00072         CALL    INI_OSC     ;Inicializa el oscilador interno a 8 MHz
0007   2???           00073         CALL    INI_ES      ;Inicializa los puertos E/S   
0008   2???           00074         CALL    INI_ADC     ;Inicializa módulo conversión ADC
0009   2???           00075         CALL    INI_TMR2    ;Inicializa el tmr2
000A   2???           00076         CALL    INI_CCP2    ;Inicializa el tmr1 y ccp2
                      00077         BANCO0
000B   1303               M         BCF     STATUS,RP1
000C   1283               M         BCF     STATUS,RP0
000D   1285           00078         BCF     TRIG        ;Inicializa a 0 el trigger
000E   2???           00079         CALL    INI_INT     ;Inicializa las interrupciones
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000F   01A1           00080         CLRF    PALMADAS    ;Limpia la variable palmadas
                      00081         
0010   1921           00082 BUCLE   BTFSC   PALMADAS,2  ;Comprobación del número de palmadas
0011   2???           00083         GOTO    ES45
0012   18A1           00084         BTFSC   PALMADAS,1  
0013   2???           00085         GOTO    ES23
0014   2???           00086         GOTO    ES01
0015   1821           00087 ES45    BTFSC   PALMADAS,0
0016   2???           00088         GOTO    CINCO       ;Cuenta 5 palmadas
0017   2???           00089         GOTO    CUATRO      ;Cuenta 4 palmadas
0018   1821           00090 ES23    BTFSC   PALMADAS,0
0019   2???           00091         GOTO    TRES        ;Cuenta 3 palmadas
001A   2???           00092         GOTO    DOS         ;Cuenta 2 palmadas
001B   1821           00093 ES01    BTFSC   PALMADAS,0
001C   2???           00094         GOTO    UNO         ;Cuenta 1 palmada
001D   2???           00095         GOTO    CERO        ;Cuenta 0 palmadas
                      00096         
001E   2???           00097 BUCLE2  CALL    RETARDO2    ;Retardo de 0,66 s
001F   1685           00098         BSF     TRIG        ;Manda un trigger al sensor de ultrasonido
0020   2???           00099         CALL    RETARDO     ;Durante 10us
0021   1285           00100         BCF     TRIG        ;Deja de mandar el trigger 
0022   2???           00101         CALL    RETARDO3    ;Retardo de 90 ms
0023   2???           00102         GOTO    BUCLE
                      00103         
                      00104 ;==============================================================================
                      00105 ;                               Subrutinas
                      00106 ;==============================================================================
                      00107 
                      00108 #INCLUDE <INICIALIZACIONES.INC> 
                      00001 ;-------------------------------------------------------------------------
                      00002 ;                           Inicializaciones                        
                      00003 ;-------------------------------------------------------------------------
                      00004         
                      00005         
                      00006 ;-------------------------------------------------------------------------
                      00007 ;----             Configuración del oscilador (8 MHz)                 ----
                      00008 ;-------------------------------------------------------------------------
0024                  00009 INI_OSC 
                      00010         BANCO1
0024   1303               M         BCF     STATUS,RP1
0025   1683               M         BSF     STATUS,RP0
0026   3077           00011         MOVLW   B'01110111'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0027   008F           00012         MOVWF   OSCCON
0028   0008           00013         RETURN 
                      00014 ;-------------------------------------------------------------------------
                      00015 ;----               Configuración de los puertos E/S                  ----
                      00016 ;-------------------------------------------------------------------------    
0029                  00017 INI_ES  
                      00018         ;---- Puerto A ---
                      00019         BANCO0
0029   1303               M         BCF     STATUS,RP1
002A   1283               M         BCF     STATUS,RP0
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002B   0185           00020         CLRF    PORTA
                      00021         BANCO1
002C   1303               M         BCF     STATUS,RP1
002D   1683               M         BSF     STATUS,RP0
002E   3001           00022         MOVLW   B'00000001'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
002F   0085           00023         MOVWF   TRISA       ;Trisa0 entrada y el resto salidas
                      00024         BANCO3
0030   1703               M         BSF     STATUS,RP1
0031   1683               M         BSF     STATUS,RP0
0032   3001           00025         MOVLW   B'00000001'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0033   0088           00026         MOVWF   ANSEL       ;AN0 pin analógico y el resto pines digitales
                      00027         
                      00028         ;----- Puerto B ---
                      00029         BANCO3 
0034   1703               M         BSF     STATUS,RP1
0035   1683               M         BSF     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0036   0189           00030         CLRF    ANSELH      ;RB[5...0] como E/S digital
0037   30C1           00031         MOVLW   B'11000001'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0038   0086           00032         MOVWF   TRISB       ;RB7, RB6 y RB0 entradas, y el resto salidas
                      00033         BANCO0
0039   1303               M         BCF     STATUS,RP1
003A   1283               M         BCF     STATUS,RP0
003B   0186           00034         CLRF    PORTB       
                      00035         
                      00036         ;----- Puerto C ---
                      00037         BANCO0
003C   1303               M         BCF     STATUS,RP1
003D   1283               M         BCF     STATUS,RP0
003E   0187           00038         CLRF    PORTC       ;Se inicializa a 0 el puerto C
                      00039         BANCO1
003F   1303               M         BCF     STATUS,RP1
0040   1683               M         BSF     STATUS,RP0
0041   3002           00040         MOVLW   B'00000010' ;RC1 entrada y el resto salidas
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0042   0087           00041         MOVWF   TRISC
                      00042             
0043   0008           00043         RETURN
                      00044            
                      00045 ;-------------------------------------------------------------------------
                      00046 ;----               Configuración de las interrupciones               ----
                      00047 ;-------------------------------------------------------------------------      
                      00048 INI_INT BANCO0
0044   1303               M         BCF     STATUS,RP1
0045   1283               M         BCF     STATUS,RP0
0046   3070           00049         MOVLW  B'01110000' 
0047   008B           00050         MOVWF  INTCON       ;Habilita máscara PEIE, T0I y INTE  
0048   018C           00051         CLRF    PIR1        ;Limpia banderas periféricos
0049   018D           00052         CLRF    PIR2        ;Limpia banderas periféricos
                      00053               
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00054         ;-- Interrupción externa de palmadas --
                      00055         BANCO1
004A   1303               M         BCF     STATUS,RP1
004B   1683               M         BSF     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004C   1701           00056         BSF  OPTION_REG,INTEDG  ;Interrupción pin INT en alto
                      00057               
                      00058         ;-- Interrupción periféricos(conversor A/D)--
                      00059               
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004D   170C           00060         BSF PIE1,ADIE       ;Activa máscara que permite A/D interrupción
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004E   148C           00061         BSF PIE1,TMR2IE     ;Activa máscara que permite TMR2 interrupción
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004F   140C           00062         BSF PIE1,TMR1IE     ;Activa máscara que permite TMR1 interrupción
                      00063               
                      00064         ;-- Interrupción módulo CCP2 --
                      00065               
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0050   140D           00066         BSF PIE2,CCP2IE     ;Activa máscara de CCP2
                      00067         
0051   018D           00068         CLRF    PIR2        ;Limpia banderas periféricos
0052   178B           00069         BSF     INTCON,GIE  ;Habilita máscara global
0053   0008           00070         RETURN
                      00071               
                      00072 ;----------------------------------------------------------------------------
                      00073 ;----               Configuración módulo conversión A/D                  ----
                      00074 ;----------------------------------------------------------------------------   
                      00075 INI_ADC BANCO0
0054   1303               M         BCF     STATUS,RP1
0055   1283               M         BCF     STATUS,RP0
0056   3081           00076         MOVLW  B'10000001' ;Canal AN0, Fosc/32 , DONE#, habilitada ADC.
0057   009F           00077         MOVWF  ADCON0
                      00078         
                      00079         BANCO1
0058   1303               M         BCF     STATUS,RP1
0059   1683               M         BSF     STATUS,RP0
005A   3000           00080         MOVLW  B'00000000' ;Voltaje referencia interno (Vss,Vdd)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
005B   009F           00081         MOVWF  ADCON1      ;Justificación izquierda
                      00082                            ;8 bits más significativos en ADRESH
                      00083                                 
005C   2???           00084         CALL  DELAY        ;Tiempo de adquisición (TACQ= 6us)
                      00085         BANCO0
005D   1303               M         BCF     STATUS,RP1
005E   1283               M         BCF     STATUS,RP0
005F   149F           00086         BSF   ADCON0,GO    ;Inicia la conversión A/D
                      00087            
0060   0008           00088         RETURN
                      00089             
                      00090 ;--- Tiempo adquisición (Tacq= 6us), espera para nueva conversión A/D         
                      00091 
0061   3004           00092 DELAY   MOVLW   D'4'        ;w toma el valor 4  
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0062   00A0           00093         MOVWF   DLAY        ;dlay = 4   
                      00094         
0063   0BA0           00095 LOOP    DECFSZ  DLAY,F      ;dlay = dlay - 1 y salta si es cero
0064   2???           00096         GOTO    LOOP
0065   0008           00097         RETURN      
                      00098         
                      00099 ;----------------------------------------------------------------------------
                      00100 ;----                    Configuración TMR2                              ----
                      00101 ;----------------------------------------------------------------------------           
0066                  00102 INI_TMR2
                      00103         BANCO0
0066   1303               M         BCF     STATUS,RP1
0067   1283               M         BCF     STATUS,RP0
0068   307B           00104         MOVLW   B'01111011' ;PRE y POST scalers a 16. TMR2 desactivado
0069   0092           00105         MOVWF   T2CON       
006A   0191           00106         CLRF    TMR2        ;Inicializa el TMR2
006B   303C           00107         MOVLW   D'60'
006C   00A3           00108         MOVWF   TIMER       ;El número de veces que salta el TMR2 
                      00109                             ;Total= 3,2 segundos
006D   0008           00110         RETURN
                      00111         
                      00112 ;-----------------------------------------------------------------------------
                      00113 ;---                   Configuración TMR1 y CCP2                          ----
                      00114 ;-----------------------------------------------------------------------------  
006E                  00115 INI_CCP2
                      00116         BANCO0
006E   1303               M         BCF     STATUS,RP1
006F   1283               M         BCF     STATUS,RP0
0070   3000           00117         MOVLW   B'00000000' ;Reloj interno,Prescaler a 1, TMR1 deshabilitado
0071   0090           00118         MOVWF   T1CON       
0072   018E           00119         CLRF    TMR1L       ;Inicializa el TIMER1
0073   018F           00120         CLRF    TMR1H           
                      00121         
0074   3005           00122         MOVLW   B'00000101' ;Modo captura cada pulso de subida
0075   009D           00123         MOVWF   CCP2CON
0076   019B           00124         CLRF    CCPR2       ;Inicializa los registros del CCP2 (ccpr2L y ccpr2H)
                      00125         
0077   0008           00126         RETURN
                      00109 #INCLUDE <INTERRUPCION.INC>
                      00001 ;-------------------------------------------------------------------------
                      00002 ;                  Rutina de Servicio de Interrupción                       
                      00003 ;-------------------------------------------------------------------------
                      00004 
0078                  00005 INTERRUPCION
                      00006     
                      00007     ;--- Salvaguarda del contexto ---
0078   00A5           00008     MOVWF   W_TEMP          ;W_TEMP = W
0079   0E03           00009     SWAPF   STATUS,W        ;W = STATUS con nibbles intercambiados
007A   00A4           00010     MOVWF   STATUS_TEMP     ;STATUS_TEMP = STATUS con nibbles intercambiados
                      00011       
                      00012     ;-----------------------------------------------------------------------
                      00013     ;-- Comprobación interrupción TMR1--
                      00014     BANCO0
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007B   1303               M         BCF     STATUS,RP1
007C   1283               M         BCF     STATUS,RP0
007D   180C           00015     BTFSC   PIR1,TMR1IF     ;Comprueba la bandera del TMR1
007E   2???           00016     CALL    TMR1INT         ;Se ha producido interrupción TMR1
                      00017     
                      00018     ;-----------------------------------------------------------------------
                      00019     ;-- Comprobación interrupción CCP2--
                      00020     BANCO0
007F   1303               M         BCF     STATUS,RP1
0080   1283               M         BCF     STATUS,RP0
0081   180D           00021     BTFSC   PIR2,CCP2IF     ;Comprueba la bandera del CCP2
0082   2???           00022     CALL    CCPINT          ;Se ha producido interrupción CCP2
                      00023     
                      00024     ;-----------------------------------------------------------------------
                      00025     ;-- Comprobación interrupción palmada-- 
                      00026     
0083   1C8B           00027     BTFSS   INTCON,INTF     ;Comprueba la bandera de int. exterior
0084   2???           00028     GOTO    SIGUE           ;No se ha producido int. exterior
0085   2???           00029     CALL    APLAUSO         ;Se ha producido int.exterior
0086   108B           00030     BCF     INTCON,INTF     ;Borra bandera int. exterior
                      00031     ;------------------------------    
0087                  00032 SIGUE   
                      00033     
                      00034     ;-- Comprobación interrupción fin de conversión A/D--
                      00035      BANCO0
0087   1303               M         BCF     STATUS,RP1
0088   1283               M         BCF     STATUS,RP0
0089   1F0C           00036      BTFSS  PIR1, ADIF      ;Comprueba la bandera de fin conversión A/D
008A   2???           00037      GOTO   SIGUE1          ;No se ha producido ADC
008B   2???           00038      CALL   LDR             ;Se ha producido int. por fin ADC
008C   130C           00039      BCF    PIR1,ADIF       ;Borra bandera de fin conversión A/D
008D   2???           00040      CALL   DELAY           ;Tiempo de adquisición
008E   149F           00041      BSF    ADCON0,GO       ;Vuelve a inicia conversión A/D
                      00042      
                      00043     ;-------------------------------
008F                  00044 SIGUE1                      
                      00045     
                      00046     ;-- Comprobación interrupción TMR2--
                      00047     BANCO0
008F   1303               M         BCF     STATUS,RP1
0090   1283               M         BCF     STATUS,RP0
0091   188C           00048     BTFSC   PIR1,TMR2IF     ;Comprueba la bandera del TMR2
0092   2???           00049     CALL    TMR2INT         ;Se ha producido interrupción TMR2
0093   108C           00050     BCF     PIR1,TMR2IF     ;Borra bandera TMR2
                      00051     
                      00052     
                      00053     ;--- Restauración del contexto ---
0094   0E24           00054     SWAPF   STATUS_TEMP,W   ;W = STATUS original con nibbles correctos
0095   0083           00055     MOVWF   STATUS          ;STATUS = STATUS original
0096   0EA5           00056     SWAPF   W_TEMP,F        ;W_TEMP = W original con nibbles intercambiados
0097   0E25           00057     SWAPF   W_TEMP,W        ;W = W original con nibbles correctos
                      00058     
0098   0009           00059     RETFIE
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00110 #INCLUDE <LDR.INC>      
                      00001 
                      00002 ;============================================================================== 
                      00003 ;                               Subrutina LDR                                 
                      00004 ;==============================================================================
                      00005         
                      00006 ;   Con luz tensión de AN0 = 3.76 V   
                      00007 ;   Sin luz tensión de AN0 = 0.9 V      
                      00008         
                      00009 ;------------------------------------------------------------------------------
                      00010 ;                           Comparación con un nivel
                      00011 ;                               Nivel = 1280 mV 
                      00012 ;------------------------------------------------------------------------------
0099                  00013 LDR         
0099   303F           00014         MOVLW   B'00111111'  ; w está entre 1260 mV y 1280 mV
009A   021E           00015         SUBWF   ADRESH,W     ;(ADRESH)-(w) ->(w)
009B   1C03           00016         BTFSS   STATUS,C   
009C   2???           00017         GOTO    LED_ON     ;Como(ADRESH < w) no hay luz, las luces se encienden
009D   1027           00018         BCF     SILED,0    ;Como(ADRESH >=w) hay luz, las luces del coche 
                      00019                            ;se deberan apagar y la variable siled toma valor 0
009E   0008           00020         RETURN
                      00021      
009F   1427           00022 LED_ON  BSF     SILED,0     ;Las luces de coche se deberán encender, por tanto
                      00023                             ;la variable siled toma el valor 1
                      00024 
00A0   0008           00025         RETURN
                      00111 #INCLUDE <SUBRUTINAS.INC>
                      00001 ;-------------------------------------------------------------------------
                      00002 ;                               Subrutinas                          
                      00003 ;-------------------------------------------------------------------------
                      00004 ;--- Retardo1 = 15 us ----
00A1   300A           00005 RETARDO MOVLW   D'10'
00A2   00A8           00006         MOVWF   CONTADOR
00A3   0BA8           00007 CUENTA  DECFSZ  CONTADOR,F
00A4   2???           00008         GOTO    CUENTA      
00A5   0008           00009         RETURN                      
                      00010         
                      00011 ;--- Retardo2 = 0.66 s ----
00A6                  00012 RETARDO2
00A6   30C8           00013         MOVLW   D'200'          
00A7   00A8           00014         MOVWF   CONTADOR        
00A8   0BA8           00015 CUENTA2 DECFSZ  CONTADOR,F
00A9   2???           00016         GOTO    CUENTA3     
00AA   0008           00017         RETURN
                      00018         
00AB   30C8           00019 CUENTA3 MOVLW   D'200'
00AC   00A9           00020         MOVWF   CONTADOR2
00AD   0BA9           00021 CUENTA4 DECFSZ  CONTADOR2,F
00AE   2???           00022         GOTO    CUENTA5   
00AF   2???           00023         GOTO    CUENTA2
                      00024 
00B0   300A           00025 CUENTA5 MOVLW   D'10'           
00B1   00AA           00026         MOVWF   CONTADOR3
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00B2   0BAA           00027 CUENTA6 DECFSZ  CONTADOR3,F
00B3   2???           00028         GOTO    CUENTA6   
00B4   2???           00029         GOTO    CUENTA4
                      00030     
                      00031 ;--- Retardo3 = 90 ms -----
00B5                  00032 RETARDO3
00B5   30C8           00033         MOVLW   D'200'          
00B6   00A8           00034         MOVWF   CONTADOR        
00B7   0BA8           00035 CUEN2   DECFSZ  CONTADOR,F
00B8   2???           00036         GOTO    CUEN3       
00B9   0008           00037         RETURN
                      00038         
00BA   3064           00039 CUEN3   MOVLW   D'100'
00BB   00A9           00040         MOVWF   CONTADOR2
00BC   0BA9           00041 CUEN4   DECFSZ  CONTADOR2,F
00BD   2???           00042         GOTO    CUEN5   
00BE   2???           00043         GOTO    CUEN2
                      00044 
00BF   3002           00045 CUEN5   MOVLW   D'2'            
00C0   00AA           00046         MOVWF   CONTADOR3
00C1   0BAA           00047 CUEN6   DECFSZ  CONTADOR3,F
00C2   2???           00048         GOTO    CUEN6   
00C3   2???           00049         GOTO    CUEN4
                      00050         
                      00051 ;-----------------------------------------------------------------------------  
                      00052 ;----                             Aplauso                                 ----
                      00053 ;-----------------------------------------------------------------------------
                      00054 
00C4   1921           00055 APLAUSO BTFSC   PALMADAS,2      ;Si el movimiento actual del robot es distinto 
00C5   2???           00056         GOTO    SSLEEP          ;de paro con una palmada entra en modo sleep
00C6   1821           00057         BTFSC   PALMADAS,0
00C7   2???           00058         GOTO    NOCERO
00C8   18A1           00059         BTFSC   PALMADAS,1      ;Comprobar que está en paro (palmadas = 0)
00C9   2???           00060         GOTO    NOCERO
00CA   1912           00061         BTFSC   T2CON,2         ;Comprobar si el TMR 2 está encendido
00CB   2???           00062         GOTO    CNTPAL
00CC   0191           00063         CLRF    TMR2
00CD   1512           00064         BSF     T2CON,2         ;Activa el TMR2
00CE   01A2           00065         CLRF    NPALMADAS       ;Limpia la variable temporal palmadas
00CF   0AA2           00066 CNTPAL  INCF    NPALMADAS,1     ;Incrementa el valor de npalmadas
00D0   0008           00067         RETURN
00D1   3005           00068 NOCERO  MOVLW   D'5'            ;Establece valor 5 para que entre en modo sleep
00D2   00A1           00069         MOVWF   PALMADAS
00D3   0008           00070         RETURN
00D4   1C21           00071 SSLEEP  BTFSS   PALMADAS,0      ;¿Está en modo sleep que son 5 palmadas?
00D5   2???           00072         GOTO    NOCERO          ;No. Se pone en modo sleep.
00D6   01A1           00073         CLRF    PALMADAS        ;Sí. Limpia palmadas y permanece en modo sleep
00D7   0008           00074         RETURN
                      00075 
                      00076 ;-----------------------------------------------------------------------------  
                      00077 ;----                             TMR2                                    ----
                      00078 ;-----------------------------------------------------------------------------
                      00079 
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00D8   0BA3           00080 TMR2INT DECFSZ  TIMER,F      ;¿Está timer a cero?
00D9   0008           00081         RETURN               ;No
                      00082         BANCO0              
00DA   1303               M         BCF     STATUS,RP1
00DB   1283               M         BCF     STATUS,RP0
00DC   1112           00083         BCF     T2CON,2      ;Sí. Se deshabilita TMR2
00DD   303C           00084         MOVLW   D'60'        ;w toma el valor de 60 
00DE   00A3           00085         MOVWF   TIMER        ;Inicializa la variable timer a 60
00DF   0822           00086         MOVFW   NPALMADAS    ;w = npalmadas
00E0   00A1           00087         MOVWF   PALMADAS     ;palmadas = npalmadas
00E1   108C           00088         BCF     PIR1,TMR2IF  ;Limpia la bandera del TMR2
00E2   0008           00089         RETURN
                      00090         
                      00091 ;----------------------------------------------------------------------------   
                      00092 ;----                             NPALMAS                                ----
                      00093 ;----------------------------------------------------------------------------
                      00094         
                      00095 ;--Modo Parado--
                      00096 CERO    PARO                    ;El robot se para
                          M         BANCO0
00E3   1303               M         BCF     STATUS,RP1
00E4   1283               M         BCF     STATUS,RP0
00E5   1085               M         BCF     DER_RET         
00E6   1105               M         BCF     DER_AV
00E7   1205               M         BCF     IZQ_AV
00E8   1185               M         BCF     IZQ_RET
00E9   1C27           00097         BTFSS   SILED,0         ;Comprueba si se deberían encender las luces
00EA   2???           00098         GOTO    LEDSNO0         ;No se deben encender
00EB   1707           00099         BSF     LED_DEL_DER     ;Sí se deben encender
00EC   1586           00100         BSF     LED_DEL_IZQ
00ED   1687           00101         BSF     LED_TRAS_DER
00EE   1606           00102         BSF     LED_TRAS_IZQ
00EF   2???           00103         GOTO    BUCLE2
00F0   1307           00104 LEDSNO0 BCF     LED_DEL_DER     
00F1   1186           00105         BCF     LED_DEL_IZQ
00F2   1287           00106         BCF     LED_TRAS_DER
00F3   1206           00107         BCF     LED_TRAS_IZQ
00F4   2???           00108         GOTO    BUCLE2
                      00109         
                      00110         
                      00111 ;--Una Palmada--        
                      00112 UNO     AVANCE                  ;El robot avanza
                          M         BANCO0
00F5   1303               M         BCF     STATUS,RP1
00F6   1283               M         BCF     STATUS,RP0
00F7   1505               M         BSF     DER_AV          ;Rueda derecha hacia delante        
00F8   1605               M         BSF     IZQ_AV          ;Rueda izquierda hacia delante
00F9   1C27           00113         BTFSS   SILED,0         ;Comprueba si se deberían encender las luces
00FA   2???           00114         GOTO    LEDSNO1         ;No se deben encender
00FB   1707           00115         BSF     LED_DEL_DER     ;Sí, se deben encender las dos de delante
00FC   1586           00116         BSF     LED_DEL_IZQ
00FD   1287           00117         BCF     LED_TRAS_DER
00FE   1206           00118         BCF     LED_TRAS_IZQ
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00FF   2???           00119         GOTO    BUCLE2  
0100   1307           00120 LEDSNO1 BCF     LED_DEL_DER     
0101   1186           00121         BCF     LED_DEL_IZQ
0102   1287           00122         BCF     LED_TRAS_DER
0103   1206           00123         BCF     LED_TRAS_IZQ
0104   2???           00124         GOTO    BUCLE2
                      00125         
                      00126 ;--Dos Palmadas--
                      00127 DOS     RETROC                  ;El robot retrocede
                          M         BANCO0
0105   1303               M         BCF     STATUS,RP1
0106   1283               M         BCF     STATUS,RP0
0107   1485               M         BSF     DER_RET         ;Rueda derecha hacia atrás
0108   1585               M         BSF     IZQ_RET         ;Rueda izquierda hacia atrás
0109   1C27           00128         BTFSS   SILED,0         ;Comprueba si se debería encender las luces
010A   2???           00129         GOTO    LEDSNO2         ;No se deben encender
010B   1687           00130         BSF     LED_TRAS_DER    ;Sí, se deben encender las dos de atrás    
010C   1606           00131         BSF     LED_TRAS_IZQ
010D   1307           00132         BCF     LED_DEL_DER
010E   1186           00133         BCF     LED_DEL_IZQ
010F   2???           00134         GOTO    BUCLE2  
0110   1287           00135 LEDSNO2 BCF     LED_TRAS_DER    
0111   1206           00136         BCF     LED_TRAS_IZQ
0112   1307           00137         BCF     LED_DEL_DER
0113   1186           00138         BCF     LED_DEL_IZQ
0114   2???           00139         GOTO    BUCLE2
                      00140         
                      00141 ;--Tres Palmadas--
                      00142 TRES    GIRO_D                  ;El robot gira a la derecha
                          M         BANCO0
0115   1303               M         BCF     STATUS,RP1
0116   1283               M         BCF     STATUS,RP0
0117   1605               M         BSF     IZQ_AV          ;Rueda izquierda hacia delante
0118   1485               M         BSF     DER_RET         ;Rueda derecha hacia atrás
0119   1C27           00143         BTFSS   SILED,0         ;Comprueba si se debería encender las luces
011A   2???           00144         GOTO    LEDSNO3         ;No se deben encender
011B   1707           00145         BSF     LED_DEL_DER     ;Sí,se deben encender las dos de la derecha
011C   1687           00146         BSF     LED_TRAS_DER
011D   1206           00147         BCF     LED_TRAS_IZQ
011E   1186           00148         BCF     LED_DEL_IZQ
011F   2???           00149         GOTO    BUCLE2  
0120   1307           00150 LEDSNO3 BCF     LED_DEL_DER     
0121   1287           00151         BCF     LED_TRAS_DER
0122   1206           00152         BCF     LED_TRAS_IZQ
0123   1186           00153         BCF     LED_DEL_IZQ
0124   2???           00154         GOTO    BUCLE2
                      00155         
                      00156 ;--Cuatro Palmadas--
                      00157 CUATRO  GIRO_I                  ;El robot gira a la izquierda 
                          M         BANCO0
0125   1303               M         BCF     STATUS,RP1
0126   1283               M         BCF     STATUS,RP0
0127   1505               M         BSF     DER_AV          ;Rueda derecha hacia delante
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0128   1585               M         BSF     IZQ_RET         ;Rueda izquierda hacia atrás
0129   1C27           00158         BTFSS   SILED,0         ;Comprueba si se debría encender las luces
012A   2???           00159         GOTO    LEDSNO4         ;No se deben encender
012B   1586           00160         BSF     LED_DEL_IZQ     ;Sí,se deben encender las dos de la izquierda
012C   1606           00161         BSF     LED_TRAS_IZQ
012D   1287           00162         BCF     LED_TRAS_DER
012E   1307           00163         BCF     LED_DEL_DER
012F   2???           00164         GOTO    BUCLE2
0130   1307           00165 LEDSNO4 BCF     LED_DEL_DER     
0131   1287           00166         BCF     LED_TRAS_DER
0132   1206           00167         BCF     LED_TRAS_IZQ
0133   1186           00168         BCF     LED_DEL_IZQ
0134   2???           00169         GOTO    BUCLE2
                      00170         
                      00171 ;--- Cinco Palmadas y Modo Sleep ---
                      00172 ; Modo en el que entra al darle una palmada mientras está en cualquier otro estado
                      00173         
0135   3015           00174 CINCO   MOVLW   B'00010101'     ;Deshabilita todas las interrupciones excepto 
0136   058B           00175         ANDWF   INTCON,F        ;la exterior. Borra flag int. exterior. Se 
                      00176                                 ;conservan los flags de TMR0 y PORTB.
                      00177         
                      00178         BANCO0
0137   1303               M         BCF     STATUS,RP1
0138   1283               M         BCF     STATUS,RP0
0139   0805           00179         MOVF    PORTA,W         ;Guarda el estado del Puerto A
013A   00A6           00180         MOVWF   PORTA_TEMP
                      00181         
                      00182         
013B   1205           00183         BCF     IZQ_AV          ;Pone salidas puente H y Trigg. a 0
013C   1185           00184         BCF     IZQ_RET
013D   1105           00185         BCF     DER_AV
013E   1085           00186         BCF     DER_RET
013F   1285           00187         BCF     TRIG
                      00188         
0140   1307           00189         BCF     LED_DEL_DER     
0141   1287           00190         BCF     LED_TRAS_DER
0142   1206           00191         BCF     LED_TRAS_IZQ
0143   1186           00192         BCF     LED_DEL_IZQ
                      00193         
                      00194         
0144   0063           00195         SLEEP                   ;El uC entra en modo Sleep y sale cuando se
                      00196                                 ;produce una nueva interrupción externa.
                      00197                                 
                      00198                                 ;Al estar deshabilitado el bit GIE, una vez
                      00199                                 ;despierte el uC continuará con la instr. que
                      00200                                 ;viene a continuación, en lugar de ir al vector
                      00201                                 ;de interrupción (0004h).
                      00202         
                      00203         
0145   30F0           00204         MOVLW   B'11110000'     ;Se vuelven a habilitar las int. PEIE y T0IE
0146   048B           00205         IORWF   INTCON,F        ;(periféricos y TMR 0).
                      00206         
                      00207         BANCO0
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0147   1303               M         BCF     STATUS,RP1
0148   1283               M         BCF     STATUS,RP0
0149   2???           00208         CALL    DELAY           ;Tiempo de adquisición
014A   149F           00209         BSF     ADCON0,GO       ;Se vuelve a iniciar la conversión A/D
014B   2???           00210         GOTO    BUCLE2          ;Va bucle2 del programa principal
                      00211          
                      00212         
                      00213 ;------------------------------------------------------------------------------ 
                      00214 ;----                         Interrupción CCP2                             ---
                      00215 ;------------------------------------------------------------------------------ 
                      00216 CCPINT  BANCO0
014C   1303               M         BCF     STATUS,RP1
014D   1283               M         BCF     STATUS,RP0
014E   1C1D           00217         BTFSS   CCP2CON,0   ;¿Está el modo captura en subida?
014F   2???           00218         GOTO    BAJADA
0150   101D           00219         BCF     CCP2CON,0   ;Pone el CCP2 para que salte con bajada
                      00220 
0151   018E           00221         CLRF    TMR1L       ;Limpia los registros de tmr1
0152   018F           00222         CLRF    TMR1H
0153   1410           00223         BSF     T1CON,0     ;Activa el tmr1
0154   100D           00224         BCF     PIR2,0      ;Limpia la bandera de ccp2
0155   0008           00225         RETURN
                      00226 BAJADA  BANCO0
0156   1303               M         BCF     STATUS,RP1
0157   1283               M         BCF     STATUS,RP0
0158   1C10           00227         BTFSS   T1CON,0     ;¿Está el tmr1 activado?
0159   2???           00228         GOTO    NOOBSTAC    ;No. Significa que no hay obstáculo
015A   1010           00229         BCF     T1CON,0     ;Sí. Entonces desactiva el tmr1 
015B   141D           00230         BSF     CCP2CON,0   ;Pone el CCP2 para que salte con subida
                      00231         
                      00232 ; Ahora se compara el valor de anchura del Echo (que está en ccpr2h y ccpr2l)
                      00233 ; con una distancia de 35 cm.
                      00234         
015C   300F           00235         MOVLW   B'00001111' 
015D   021C           00236         SUBWF   CCPR2H,W    ;(ccpr2h)-(w)-> w
015E   1C03           00237         BTFSS   STATUS,C    ; Comprueba si obstáculo está a más de 35cm
015F   2???           00238         GOTO    OBSTAC      ;(ccpr2h)< w por tanto hay obstaculo a d<=35cm
0160   100D           00239         BCF     PIR2,0      ;(ccpr2h)< w por tanto el obstáculo está a d >35cm
                      00240                             ; y no modifica su trayectoria
                      00241                             
0161   100D           00242         BCF     PIR2,0      ;Limpia la bandera ccp2
0162   1010           00243         BCF     T1CON,0     ;Desactiva el tmr1
0163   018F           00244         CLRF    TMR1H       ;Limpia los registros de tmr1 
0164   018E           00245         CLRF    TMR1L
0165   0008           00246         RETURN
                      00247         
                      00248 OBSTAC  PARO                ;Hay obstáculo y se detiene durante 0.66 seg
                          M         BANCO0
0166   1303               M         BCF     STATUS,RP1
0167   1283               M         BCF     STATUS,RP0
0168   1085               M         BCF     DER_RET         
0169   1105               M         BCF     DER_AV
016A   1205               M         BCF     IZQ_AV
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

016B   1185               M         BCF     IZQ_RET
016C   2???           00249         CALL    RETARDO2    
                      00250         RETROC              ;Retrocede durante 1.32 seg
                          M         BANCO0
016D   1303               M         BCF     STATUS,RP1
016E   1283               M         BCF     STATUS,RP0
016F   1485               M         BSF     DER_RET         ;Rueda derecha hacia atrás
0170   1585               M         BSF     IZQ_RET         ;Rueda izquierda hacia atrás
0171   2???           00251         CALL    RETARDO2   
0172   2???           00252         CALL    RETARDO2
                      00253         PARO                ;Se detiene durante 0.66 seg
                          M         BANCO0
0173   1303               M         BCF     STATUS,RP1
0174   1283               M         BCF     STATUS,RP0
0175   1085               M         BCF     DER_RET         
0176   1105               M         BCF     DER_AV
0177   1205               M         BCF     IZQ_AV
0178   1185               M         BCF     IZQ_RET
0179   2???           00254         CALL    RETARDO2
                      00255         GIRO_I              ;Gira durante 0.66 seg
                          M         BANCO0
017A   1303               M         BCF     STATUS,RP1
017B   1283               M         BCF     STATUS,RP0
017C   1505               M         BSF     DER_AV          ;Rueda derecha hacia delante
017D   1585               M         BSF     IZQ_RET         ;Rueda izquierda hacia atrás
017E   2???           00256         CALL    RETARDO2
                      00257         PARO                ;Se detiene
                          M         BANCO0
017F   1303               M         BCF     STATUS,RP1
0180   1283               M         BCF     STATUS,RP0
0181   1085               M         BCF     DER_RET         
0182   1105               M         BCF     DER_AV
0183   1205               M         BCF     IZQ_AV
0184   1185               M         BCF     IZQ_RET
0185   100D           00258         BCF     PIR2,0      ;Limpia la bandera ccp2
0186   1010           00259         BCF     T1CON,0     ;Desactiva el tmr1
0187   018F           00260         CLRF    TMR1H       ;Limpia los registros de tmr1
0188   018E           00261         CLRF    TMR1L
0189   0008           00262         RETURN
                      00263         
018A   100D           00264 NOOBSTAC BCF    PIR2,0          ;Limpia la bandera ccp2
018B   141D           00265          BSF    CCP2CON,CCP2M0  ;Pone el CCP2 para que salte con subida
018C   0008           00266          RETURN
                      00267          
                      00268 ;------------------------------------------------------------------------------
                      00269 ;---                        Interrupción TMR1                              ----
                      00270 ;------------------------------------------------------------------------------  
                      00271 ;Significa que no hay obstáculo a una distancia de 3 o 4 metros 
                      00272 
                      00273 TMR1INT  BANCO0
018D   1303               M         BCF     STATUS,RP1
018E   1283               M         BCF     STATUS,RP0
018F   1010           00274          BCF    T1CON,0   ;Desactiva el tmr1
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0190   100C           00275          BCF    PIR1,0    ;Borra la bandera tmr1
0191   0000           00276          NOP
0192   0008           00277          RETURN
                      00278         
                      00112         
                      00113         
0FF5 3EFF             00114     END
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 17


SYMBOL TABLE
  LABEL                             VALUE 

ABDEN                             00000000
ABDOVF                            00000007
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000006
ADCS1                             00000007
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
ANS0                              00000000
ANS1                              00000001
ANS10                             00000002
ANS11                             00000003
ANS12                             00000004
ANS13                             00000005
ANS2                              00000002
ANS3                              00000003
ANS4                              00000004
ANS8                              00000000
ANS9                              00000001
ANSEL                             00000188
ANSELH                            00000189
APLAUSO                           000000C4
AVANCE                            
BAJADA                            00000156
BANCO0                            
BANCO1                            
BANCO2                            
BANCO3                            
BAUDCTL                           00000187
BCLIE                             00000003
BCLIF                             00000003
BF                                00000000
BRG0                              00000000
BRG1                              00000001
BRG10                             00000002
BRG11                             00000003
BRG12                             00000004
BRG13                             00000005
BRG14                             00000006
BRG15                             00000007
BRG16                             00000003
BRG2                              00000002
BRG3                              00000003
BRG4                              00000004
BRG5                              00000005
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 18


SYMBOL TABLE
  LABEL                             VALUE 

BRG6                              00000006
BRG7                              00000007
BRG8                              00000000
BRG9                              00000001
BRGH                              00000002
BUCLE                             00000010
BUCLE2                            0000001E
C                                 00000000
C1CH0                             00000000
C1CH1                             00000001
C1IE                              00000005
C1IF                              00000005
C1OE                              00000005
C1ON                              00000007
C1OUT                             00000006
C1POL                             00000004
C1R                               00000002
C1RSEL                            00000005
C1SEN                             00000005
C2CH0                             00000000
C2CH1                             00000001
C2IE                              00000006
C2IF                              00000006
C2OE                              00000005
C2ON                              00000007
C2OUT                             00000006
C2POL                             00000004
C2R                               00000002
C2REN                             00000004
C2RSEL                            00000004
C2SYNC                            00000000
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPINT                            0000014C
CCPR1                             00000015
CCPR1H                            00000016
CCPR1L                            00000015
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 19


SYMBOL TABLE
  LABEL                             VALUE 

CCPR2                             0000001B
CCPR2H                            0000001C
CCPR2L                            0000001B
CERO                              000000E3
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CHS3                              00000005
CINCO                             00000135
CKE                               00000006
CKP                               00000004
CM1CON0                           00000107
CM2CON0                           00000108
CM2CON1                           00000109
CNTPAL                            000000CF
CONTADOR                          00000028
CONTADOR2                         00000029
CONTADOR3                         0000002A
CREN                              00000004
CSRC                              00000007
CUATRO                            00000125
CUEN2                             000000B7
CUEN3                             000000BA
CUEN4                             000000BC
CUEN5                             000000BF
CUEN6                             000000C1
CUENTA                            000000A3
CUENTA2                           000000A8
CUENTA3                           000000AB
CUENTA4                           000000AD
CUENTA5                           000000B0
CUENTA6                           000000B2
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DC2B0                             00000004
DC2B1                             00000005
DELAY                             00000061
DER_AV                            PORTA,RA2
DER_RET                           PORTA,RA1
DLAY                              00000020
DOS                               00000105
D_A                               00000005
D_NOT_A                           00000005
ECCPAS                            0000009C
ECCPAS0                           00000004
ECCPAS1                           00000005
ECCPAS2                           00000006
ECCPASE                           00000007
EEADR                             0000010D
EEADRH                            0000010F
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 20


SYMBOL TABLE
  LABEL                             VALUE 

EECON1                            0000018C
EECON2                            0000018D
EEDAT                             0000010C
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
ES01                              0000001B
ES23                              00000018
ES45                              00000015
F                                 00000001
FERR                              00000002
FSR                               00000004
FVREN                             00000000
GCEN                              00000007
GIE                               00000007
GIRO_D                            
GIRO_I                            
GO                                00000001
GO_DONE                           00000001
GO_NOT_DONE                       00000001
HTS                               00000002
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
INDF                              00000000
INICIO                            00000006
INI_ADC                           00000054
INI_CCP2                          0000006E
INI_ES                            00000029
INI_INT                           00000044
INI_OSC                           00000024
INI_TMR2                          00000066
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTERRUPCION                      00000078
INTF                              00000001
IOCB                              00000096
IOCB0                             00000000
IOCB1                             00000001
IOCB2                             00000002
IOCB3                             00000003
IOCB4                             00000004
IOCB5                             00000005
IOCB6                             00000006
IOCB7                             00000007
IRCF0                             00000004
IRCF1                             00000005
IRCF2                             00000006
IRP                               00000007
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 21


SYMBOL TABLE
  LABEL                             VALUE 

IZQ_AV                            PORTA,RA4
IZQ_RET                           PORTA,RA3
LDR                               00000099
LED                               PORTC,RC4
LEDSNO0                           000000F0
LEDSNO1                           00000100
LEDSNO2                           00000110
LEDSNO3                           00000120
LEDSNO4                           00000130
LED_DEL_DER                       PORTC,RC6
LED_DEL_IZQ                       PORTB,RB3
LED_ON                            0000009F
LED_TRAS_DER                      PORTC,RC5
LED_TRAS_IZQ                      PORTB,RB4
LOOP                              00000063
LTS                               00000001
MC1OUT                            00000007
MC2OUT                            00000006
MSK                               00000093
MSK0                              00000000
MSK1                              00000001
MSK2                              00000002
MSK3                              00000003
MSK4                              00000004
MSK5                              00000005
MSK6                              00000006
MSK7                              00000007
NOCERO                            000000D1
NOOBSTAC                          0000018A
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000001
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
NPALMADAS                         00000022
OBSTAC                            00000166
OERR                              00000001
OPTION_REG                        00000081
OSCCON                            0000008F
OSCTUNE                           00000090
OSFIE                             00000007
OSFIF                             00000007
OSTS                              00000003
P                                 00000004
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 22


SYMBOL TABLE
  LABEL                             VALUE 

P1M0                              00000006
P1M1                              00000007
PALMADAS                          00000021
PARO                              
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PDC0                              00000000
PDC1                              00000001
PDC2                              00000002
PDC3                              00000003
PDC4                              00000004
PDC5                              00000005
PDC6                              00000006
PEIE                              00000006
PEN                               00000002
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PORTA                             00000005
PORTA_TEMP                        00000026
PORTB                             00000006
PORTC                             00000007
PORTE                             00000009
PR2                               00000092
PRSEN                             00000007
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSSAC0                            00000002
PSSAC1                            00000003
PSSBD0                            00000000
PSSBD1                            00000001
PSTRCON                           0000009D
PULSR                             00000002
PULSS                             00000003
PWM1CON                           0000009B
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RA6                               00000006
RA7                               00000007
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 23


SYMBOL TABLE
  LABEL                             VALUE 

RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIDL                             00000006
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
RE3                               00000003
READ_WRITE                        00000002
RETARDO                           000000A1
RETARDO2                          000000A6
RETARDO3                          000000B5
RETROC                            
RP0                               00000005
RP1                               00000006
RSEN                              00000001
RX9                               00000006
RX9D                              00000000
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
SBOREN                            00000004
SCKP                              00000004
SCS                               00000000
SEN                               00000000
SENDB                             00000003
SIGUE                             00000087
SIGUE1                            0000008F
SILED                             00000027
SMP                               00000007
SPBRG                             00000099
SPBRGH                            0000009A
SPEN                              00000007
SR0                               00000006
SR1                               00000007
SRCON                             00000185
SREN                              00000005
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 24


SYMBOL TABLE
  LABEL                             VALUE 

SSLEEP                            000000D4
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPMSK                            00000093
SSPOV                             00000006
SSPSTAT                           00000094
STATUS                            00000003
STATUS_TEMP                       00000024
STRA                              00000000
STRB                              00000001
STRC                              00000002
STRD                              00000003
STRSYNC                           00000004
SWDTEN                            00000000
SYNC                              00000004
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1GINV                            00000007
T1GIV                             00000007
T1GSS                             00000001
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TIMER                             00000023
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TMR1                              0000000E
TMR1CS                            00000001
TMR1GE                            00000006
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1INT                           0000018D
TMR1L                             0000000E
TMR1ON                            00000000
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 25


SYMBOL TABLE
  LABEL                             VALUE 

TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2INT                           000000D8
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRES                              00000115
TRIG                              PORTA,RA5
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISA6                            00000006
TRISA7                            00000007
TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000087
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRISE                             00000089
TRISE3                            00000003
TRMT                              00000001
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 26


SYMBOL TABLE
  LABEL                             VALUE 

TXREG                             00000019
TXSTA                             00000098
UA                                00000001
ULPWUE                            00000005
ULPWUIE                           00000002
ULPWUIF                           00000002
UNO                               000000F5
VCFG0                             00000004
VCFG1                             00000005
VR0                               00000000
VR1                               00000001
VR2                               00000002
VR3                               00000003
VRCON                             00000097
VREN                              00000007
VROE                              00000006
VRR                               00000005
VRSS                              00000004
W                                 00000000
WCOL                              00000007
WDTCON                            00000105
WDTPS0                            00000001
WDTPS1                            00000002
WDTPS2                            00000003
WDTPS3                            00000004
WPUB                              00000095
WPUB0                             00000000
WPUB1                             00000001
WPUB2                             00000002
WPUB3                             00000003
WPUB4                             00000004
WPUB5                             00000005
WPUB6                             00000006
WPUB7                             00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
WUE                               00000001
W_TEMP                            00000025
Z                                 00000002
_BOR21V                           00003EFF
_BOR40V                           00003FFF
_BOR4V_BOR21V                     00003EFF
_BOR4V_BOR40V                     00003FFF
_BOREN_NSLEEP                     00003EFF
_BOREN_OFF                        00003CFF
_BOREN_ON                         00003FFF
_BOREN_SBODEN                     00003DFF
_BOR_NSLEEP                       00003EFF
_BOR_OFF                          00003CFF
_BOR_ON                           00003FFF
_BOR_SBODEN                       00003DFF
_CONFIG1                          00002007
MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 27


SYMBOL TABLE
  LABEL                             VALUE 

_CONFIG2                          00002008
_CPD_OFF                          00003FFF
_CPD_ON                           00003F7F
_CP_OFF                           00003FFF
_CP_ON                            00003FBF
_DEBUG_OFF                        00003FFF
_DEBUG_ON                         00001FFF
_DEVID1                           00002006
_EC_OSC                           00003FFB
_EXTRC                            00003FFF
_EXTRCIO                          00003FFE
_EXTRC_OSC_CLKOUT                 00003FFF
_EXTRC_OSC_NOCLKOUT               00003FFE
_FCMEN_OFF                        000037FF
_FCMEN_ON                         00003FFF
_FOSC_EC                          00003FFB
_FOSC_EXTRC_CLKOUT                00003FFF
_FOSC_EXTRC_NOCLKOUT              00003FFE
_FOSC_HS                          00003FFA
_FOSC_INTRC_CLKOUT                00003FFD
_FOSC_INTRC_NOCLKOUT              00003FFC
_FOSC_LP                          00003FF8
_FOSC_XT                          00003FF9
_HS_OSC                           00003FFA
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_IESO_OFF                         00003BFF
_IESO_ON                          00003FFF
_INTOSC                           00003FFD
_INTOSCIO                         00003FFC
_INTRC_OSC_CLKOUT                 00003FFD
_INTRC_OSC_NOCLKOUT               00003FFC
_LP_OSC                           00003FF8
_LVP_OFF                          00002FFF
_LVP_ON                           00003FFF
_MCLRE_OFF                        00003FDF
_MCLRE_ON                         00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FEF
_WDTE_OFF                         00003FF7
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FF7
_WDT_ON                           00003FFF
_WRT_1FOURTH                      00003BFF
_WRT_256                          00003DFF
_WRT_HALF                         000039FF
_WRT_OFF                          00003FFF
_XT_OSC                           00003FF9
__16F883                          00000001

MPASM 5.63                     PRINCIPAL.ASM   1-25-2016  19:25:27         PAGE 28





Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :    12 reported,     0 suppressed

